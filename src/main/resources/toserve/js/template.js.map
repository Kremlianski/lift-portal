{"version":3,"sources":["node_modules/browser-pack/_prelude.js","frontend/ts/template.ts"],"names":[],"mappings":"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","file":"template.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\r\n//declarations\r\ndeclare interface SEvent {\r\n    from: HTMLElement\r\n    to: HTMLElement\r\n    item: HTMLElement\r\n    oldIndex?: number\r\n    newIndex?: number\r\n}\r\n\r\n\r\ninterface SpaceTemplate {\r\n    id: string\r\n    content?: Widget[]\r\n\r\n}\r\n\r\ninterface Widget {\r\n    wtype: string\r\n    wid: string\r\n    isNew?: boolean\r\n}\r\n\r\ndeclare function initWidget(item: Element): void\r\n\r\ndeclare function createSpace(item: Element): void\r\n\r\ndeclare function createSpaces():void\r\n\r\ndeclare function loadHtml(id: string):void\r\ndeclare function menuInit(id: string):void\r\n\r\n\r\ndeclare function save(widgets: SpaceTemplate[]):void\r\n\r\n\r\n//global functions\r\n\r\n;(<any> window).menuInit = function(id: string):void { \r\n    //alert(id)\r\n}\r\n\r\n;(<any> window).createSpaces = function():void {\r\n\r\n    $('.space')\r\n    \r\n    .filter(function(){\r\n        return !$(this).hasClass('space-init')\r\n    })\r\n    .addClass('space-init')\r\n    .each(function(){\r\n        createSpace(this)\r\n    })\r\n\r\n}\r\n\r\n;(<any> window).initWidget = function(item: Element):void {\r\n\r\n    const containerStr: string = `\r\n        <div class=\"panel-heading\">\r\n            <button class=\"btn btn-primary btn-sm edit-button\">\r\n               <span class=\"glyphicon glyphicon-cog\"></span>\r\n            </button>\r\n            <button class=\"btn btn-primary btn-sm close-button\">\r\n               <span class=\"glyphicon glyphicon-remove\"></span>\r\n            </button>\r\n        </div>\r\n        <div class=\"panel-body\">\r\n            <div id=\"target\"></div>\r\n        </div>\r\n        `\r\n\r\n    const children = $(item).children().get(0)\r\n    $(item)\r\n    .removeAttr('id')\r\n    .removeClass('init-widget')\r\n    .addClass('panel panel-primary widget')\r\n    .html(containerStr)\r\n    .find('.close-button')\r\n    .on('click', function(){\r\n        item.remove()\r\n    })\r\n\r\n    if(children) $(item).find('.panel-body').append(children)\r\n\r\n    $(item).find('.edit-button')\r\n    .on('click', function(){\r\n        const widget = $(item).find('[data-xx-wid]')\r\n        let str = ''\r\n        if(widget.hasClass('xx-new')) {\r\n            str=`&new=1`\r\n        }\r\n        alert(`?id=${widget.attr('data-xx-wid')}${str}`)\r\n        //window.location()\r\n    })\r\n}\r\n\r\n\r\n\r\n;(<any> window).createSpace = function(item:Element):void {\r\n\r\n    \r\n        Sortable.create(item, {\r\n            group: {\r\n                name: 'space',\r\n                put: ['editor', 'space']\r\n            } ,\r\n            animation: 100,\r\n            ghostClass: \"ghost\",\r\n            // delay: 10,\r\n            onAdd: function(event: SEvent) {\r\n                if(event.from.id == 'editor-panel') {\r\n                    const item = event.item\r\n        \r\n                    initWidget(item)\r\n                    loadHtml('id=' + $('#widget').attr('data-xx-w') + ';b=4')\r\n                //  createSpaces()\r\n                }\r\n            },\r\n            onUpdate: function(event: SEvent) {\r\n                const ids: string[] = []\r\n                $(event.to).children().each(\r\n                    function(){\r\n                        ids.push(this.id)\r\n                    })\r\n                // sort(event.to.id, ids)\r\n            },\r\n            onStart: function(event: SEvent) {\r\n                $(event.item)\r\n                .addClass('dragging')\r\n            },\r\n            onEnd: function(event: SEvent) {\r\n                $(event.item)\r\n                .removeClass('dragging')\r\n            },\r\n            draggable: '.widget'\r\n        })\r\n        }\r\n\r\n\r\n//the \"main\" method\r\n;(function(fn:()=>void) {\r\n  if (document.readyState != 'loading') fn()\r\n  else document.addEventListener('DOMContentLoaded', fn)\r\n})(\r\n    function() {\r\n        Sortable.create(document.getElementById('editor-panel'), {\r\n            group: {name:'editor', pull: 'clone'},\r\n            animation: 100,\r\n            ghostClass: \"ghost\"\r\n        })\r\n\r\n        createSpaces()\r\n\r\n        $('#containers').on('change', function(){\r\n            $('#widget').attr('data-xx-w', this.value)\r\n        })\r\n\r\n        let spaces:SpaceTemplate[] = []\r\n\r\n        $('#calculate').on('click', function(){\r\n            calculate()\r\n            save(spaces)\r\n            spaces = []\r\n        })\r\n\r\n        \r\n        init()\r\n        function calculate() {\r\n            $('.space').each(function() {\r\n                const id = $(this).attr('data-xx-sid')\r\n                const content: Widget[] = []\r\n                \r\n                $('[data-xx-wid]', this).each(function(){\r\n\r\n                    const element:Element = this\r\n                    content.push({ \r\n                        wtype: $(element).attr('data-xx-widget'),\r\n                        wid: $(element).attr('data-xx-wid'),\r\n                        isNew: $(element).hasClass('xx-new')\r\n                    })\r\n                })\r\n\r\n                spaces.push({id,  content})\r\n\r\n               }\r\n            )\r\n        }\r\n\r\n        function init():void {\r\n            $('.widget-init').each(function(){\r\n\r\n                initWidget(this)\r\n\r\n            })\r\n\r\n        }\r\n    }\r\n)\r\n\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJmcm9udGVuZC90cy90ZW1wbGF0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDc0NRLEFBQU8sT0FBQyxBQUFRLFdBQUcsVUFBUyxBQUFVO0FBQzFDLEFBQVcsQUFDZjtBQUFDLEFBRUE7QUFBTyxBQUFPLE9BQUMsQUFBWSxlQUFHO0FBRTNCLEFBQUMsTUFBQyxBQUFRLEFBQUMsVUFFVixBQUFNLE9BQUM7QUFDSixBQUFNLGVBQUMsQ0FBQyxBQUFDLEVBQUMsQUFBSSxBQUFDLE1BQUMsQUFBUSxTQUFDLEFBQVksQUFBQyxBQUMxQztBQUFDLEFBQUMsT0FDRCxBQUFRLFNBQUMsQUFBWSxBQUFDLGNBQ3RCLEFBQUksS0FBQztBQUNGLEFBQVcsb0JBQUMsQUFBSSxBQUFDLEFBQ3JCO0FBQUMsQUFBQyxBQUVOO0FBQUMsQUFFQTtBQUFPLEFBQU8sT0FBQyxBQUFVLGFBQUcsVUFBUyxBQUFhO0FBRS9DLFFBQU0sQUFBWSxBQUFXLEFBWXhCO0FBRUwsUUFBTSxBQUFRLFdBQUcsQUFBQyxFQUFDLEFBQUksQUFBQyxNQUFDLEFBQVEsQUFBRSxXQUFDLEFBQUcsSUFBQyxBQUFDLEFBQUM7QUFDMUMsQUFBQyxNQUFDLEFBQUksQUFBQyxNQUNOLEFBQVUsV0FBQyxBQUFJLEFBQUMsTUFDaEIsQUFBVyxZQUFDLEFBQWEsQUFBQyxlQUMxQixBQUFRLFNBQUMsQUFBNEIsQUFBQyw4QkFDdEMsQUFBSSxLQUFDLEFBQVksQUFBQyxjQUNsQixBQUFJLEtBQUMsQUFBZSxBQUFDLGlCQUNyQixBQUFFLEdBQUMsQUFBTyxTQUFFO0FBQ1QsQUFBSSxhQUFDLEFBQU0sQUFBRSxBQUNqQjtBQUFDLEFBQUM7QUFFRixBQUFFLFFBQUMsQUFBUSxBQUFDLFVBQUMsQUFBQyxFQUFDLEFBQUksQUFBQyxNQUFDLEFBQUksS0FBQyxBQUFhLEFBQUMsZUFBQyxBQUFNLE9BQUMsQUFBUSxBQUFDO0FBRXpE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QUFDO0FBRUYsUUFBSSxBQUFNLFNBQW1CLEFBQUU7QUFFL0IsQUFBQyxNQUFDLEFBQVksQUFBQyxjQUFDLEFBQUUsR0FBQyxBQUFPLFNBQUU7QUFDeEIsQUFBUyxBQUFFO0FBQ1gsQUFBSSxhQUFDLEFBQU0sQUFBQztBQUNaLEFBQU0saUJBQUcsQUFBRSxBQUNmO0FBQUMsQUFBQztBQUdGLEFBQUksQUFBRTtBQUNOO0FBQ0ksQUFBQyxVQUFDLEFBQVEsQUFBQyxVQUFDLEFBQUksS0FBQztBQUNiLGdCQUFNLEFBQUUsS0FBRyxBQUFDLEVBQUMsQUFBSSxBQUFDLE1BQUMsQUFBSSxLQUFDLEFBQWEsQUFBQztBQUN0QyxnQkFBTSxBQUFPLFVBQWEsQUFBRTtBQUU1QixBQUFDLGNBQUMsQUFBZSxpQkFBRSxBQUFJLEFBQUMsTUFBQyxBQUFJLEtBQUM7QUFFMUIsb0JBQU0sQUFBTyxVQUFXLEFBQUk7QUFDNUIsQUFBTyx3QkFBQyxBQUFJO0FBQ1IsQUFBSywyQkFBRSxBQUFDLEVBQUMsQUFBTyxBQUFDLFNBQUMsQUFBSSxLQUFDLEFBQWdCLEFBQUM7QUFDeEMsQUFBRyx5QkFBRSxBQUFDLEVBQUMsQUFBTyxBQUFDLFNBQUMsQUFBSSxLQUFDLEFBQWEsQUFBQztBQUNuQyxBQUFLLDJCQUFFLEFBQUMsRUFBQyxBQUFPLEFBQUMsU0FBQyxBQUFRLFNBQUMsQUFBUSxBQUFDLEFBQ3ZDLEFBQUMsQUFDTjtBQUxpQjtBQUtoQixBQUFDO0FBRUYsQUFBTSxtQkFBQyxBQUFJLEtBQUMsRUFBQyxBQUFFLFFBQUcsQUFBTyxBQUFDLEFBQUMsQUFFNUI7QUFBQyxBQUNILEFBQ0w7QUFBQztBQUVEO0FBQ0ksQUFBQyxVQUFDLEFBQWMsQUFBQyxnQkFBQyxBQUFJLEtBQUM7QUFFbkIsQUFBVSx1QkFBQyxBQUFJLEFBQUMsQUFFcEI7QUFBQyxBQUFDLEFBRU47QUFBQyxBQUNMO0FBQUMsQUFDSiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcclxuLy9kZWNsYXJhdGlvbnNcclxuZGVjbGFyZSBpbnRlcmZhY2UgU0V2ZW50IHtcclxuICAgIGZyb206IEhUTUxFbGVtZW50XHJcbiAgICB0bzogSFRNTEVsZW1lbnRcclxuICAgIGl0ZW06IEhUTUxFbGVtZW50XHJcbiAgICBvbGRJbmRleD86IG51bWJlclxyXG4gICAgbmV3SW5kZXg/OiBudW1iZXJcclxufVxyXG5cclxuXHJcbmludGVyZmFjZSBTcGFjZVRlbXBsYXRlIHtcclxuICAgIGlkOiBzdHJpbmdcclxuICAgIGNvbnRlbnQ/OiBXaWRnZXRbXVxyXG5cclxufVxyXG5cclxuaW50ZXJmYWNlIFdpZGdldCB7XHJcbiAgICB3dHlwZTogc3RyaW5nXHJcbiAgICB3aWQ6IHN0cmluZ1xyXG4gICAgaXNOZXc/OiBib29sZWFuXHJcbn1cclxuXHJcbmRlY2xhcmUgZnVuY3Rpb24gaW5pdFdpZGdldChpdGVtOiBFbGVtZW50KTogdm9pZFxyXG5cclxuZGVjbGFyZSBmdW5jdGlvbiBjcmVhdGVTcGFjZShpdGVtOiBFbGVtZW50KTogdm9pZFxyXG5cclxuZGVjbGFyZSBmdW5jdGlvbiBjcmVhdGVTcGFjZXMoKTp2b2lkXHJcblxyXG5kZWNsYXJlIGZ1bmN0aW9uIGxvYWRIdG1sKGlkOiBzdHJpbmcpOnZvaWRcclxuZGVjbGFyZSBmdW5jdGlvbiBtZW51SW5pdChpZDogc3RyaW5nKTp2b2lkXHJcblxyXG5cclxuZGVjbGFyZSBmdW5jdGlvbiBzYXZlKHdpZGdldHM6IFNwYWNlVGVtcGxhdGVbXSk6dm9pZFxyXG5cclxuXHJcbi8vZ2xvYmFsIGZ1bmN0aW9uc1xyXG5cclxuOyg8YW55PiB3aW5kb3cpLm1lbnVJbml0ID0gZnVuY3Rpb24oaWQ6IHN0cmluZyk6dm9pZCB7IFxyXG4gICAgLy9hbGVydChpZClcclxufVxyXG5cclxuOyg8YW55PiB3aW5kb3cpLmNyZWF0ZVNwYWNlcyA9IGZ1bmN0aW9uKCk6dm9pZCB7XHJcblxyXG4gICAgJCgnLnNwYWNlJylcclxuICAgIFxyXG4gICAgLmZpbHRlcihmdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiAhJCh0aGlzKS5oYXNDbGFzcygnc3BhY2UtaW5pdCcpXHJcbiAgICB9KVxyXG4gICAgLmFkZENsYXNzKCdzcGFjZS1pbml0JylcclxuICAgIC5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY3JlYXRlU3BhY2UodGhpcylcclxuICAgIH0pXHJcblxyXG59XHJcblxyXG47KDxhbnk+IHdpbmRvdykuaW5pdFdpZGdldCA9IGZ1bmN0aW9uKGl0ZW06IEVsZW1lbnQpOnZvaWQge1xyXG5cclxuICAgIGNvbnN0IGNvbnRhaW5lclN0cjogc3RyaW5nID0gYFxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJwYW5lbC1oZWFkaW5nXCI+XHJcbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgYnRuLXNtIGVkaXQtYnV0dG9uXCI+XHJcbiAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1jb2dcIj48L3NwYW4+XHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1zbSBjbG9zZS1idXR0b25cIj5cclxuICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZVwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cInBhbmVsLWJvZHlcIj5cclxuICAgICAgICAgICAgPGRpdiBpZD1cInRhcmdldFwiPjwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIGBcclxuXHJcbiAgICBjb25zdCBjaGlsZHJlbiA9ICQoaXRlbSkuY2hpbGRyZW4oKS5nZXQoMClcclxuICAgICQoaXRlbSlcclxuICAgIC5yZW1vdmVBdHRyKCdpZCcpXHJcbiAgICAucmVtb3ZlQ2xhc3MoJ2luaXQtd2lkZ2V0JylcclxuICAgIC5hZGRDbGFzcygncGFuZWwgcGFuZWwtcHJpbWFyeSB3aWRnZXQnKVxyXG4gICAgLmh0bWwoY29udGFpbmVyU3RyKVxyXG4gICAgLmZpbmQoJy5jbG9zZS1idXR0b24nKVxyXG4gICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaXRlbS5yZW1vdmUoKVxyXG4gICAgfSlcclxuXHJcbiAgICBpZihjaGlsZHJlbikgJChpdGVtKS5maW5kKCcucGFuZWwtYm9keScpLmFwcGVuZChjaGlsZHJlbilcclxuXHJcbiAgICAkKGl0ZW0pLmZpbmQoJy5lZGl0LWJ1dHRvbicpXHJcbiAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgICAgICBjb25zdCB3aWRnZXQgPSAkKGl0ZW0pLmZpbmQoJ1tkYXRhLXh4LXdpZF0nKVxyXG4gICAgICAgIGxldCBzdHIgPSAnJ1xyXG4gICAgICAgIGlmKHdpZGdldC5oYXNDbGFzcygneHgtbmV3JykpIHtcclxuICAgICAgICAgICAgc3RyPWAmbmV3PTFgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFsZXJ0KGA/aWQ9JHt3aWRnZXQuYXR0cignZGF0YS14eC13aWQnKX0ke3N0cn1gKVxyXG4gICAgICAgIC8vd2luZG93LmxvY2F0aW9uKClcclxuICAgIH0pXHJcbn1cclxuXHJcblxyXG5cclxuOyg8YW55PiB3aW5kb3cpLmNyZWF0ZVNwYWNlID0gZnVuY3Rpb24oaXRlbTpFbGVtZW50KTp2b2lkIHtcclxuXHJcbiAgICBcclxuICAgICAgICBTb3J0YWJsZS5jcmVhdGUoaXRlbSwge1xyXG4gICAgICAgICAgICBncm91cDoge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3NwYWNlJyxcclxuICAgICAgICAgICAgICAgIHB1dDogWydlZGl0b3InLCAnc3BhY2UnXVxyXG4gICAgICAgICAgICB9ICxcclxuICAgICAgICAgICAgYW5pbWF0aW9uOiAxMDAsXHJcbiAgICAgICAgICAgIGdob3N0Q2xhc3M6IFwiZ2hvc3RcIixcclxuICAgICAgICAgICAgLy8gZGVsYXk6IDEwLFxyXG4gICAgICAgICAgICBvbkFkZDogZnVuY3Rpb24oZXZlbnQ6IFNFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYoZXZlbnQuZnJvbS5pZCA9PSAnZWRpdG9yLXBhbmVsJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBldmVudC5pdGVtXHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdFdpZGdldChpdGVtKVxyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRIdG1sKCdpZD0nICsgJCgnI3dpZGdldCcpLmF0dHIoJ2RhdGEteHgtdycpICsgJztiPTQnKVxyXG4gICAgICAgICAgICAgICAgLy8gIGNyZWF0ZVNwYWNlcygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9uVXBkYXRlOiBmdW5jdGlvbihldmVudDogU0V2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZHM6IHN0cmluZ1tdID0gW11cclxuICAgICAgICAgICAgICAgICQoZXZlbnQudG8pLmNoaWxkcmVuKCkuZWFjaChcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZHMucHVzaCh0aGlzLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAvLyBzb3J0KGV2ZW50LnRvLmlkLCBpZHMpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9uU3RhcnQ6IGZ1bmN0aW9uKGV2ZW50OiBTRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICQoZXZlbnQuaXRlbSlcclxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnZHJhZ2dpbmcnKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvbkVuZDogZnVuY3Rpb24oZXZlbnQ6IFNFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgJChldmVudC5pdGVtKVxyXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdkcmFnZ2luZycpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRyYWdnYWJsZTogJy53aWRnZXQnXHJcbiAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG5cclxuLy90aGUgXCJtYWluXCIgbWV0aG9kXHJcbjsoZnVuY3Rpb24oZm46KCk9PnZvaWQpIHtcclxuICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPSAnbG9hZGluZycpIGZuKClcclxuICBlbHNlIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmbilcclxufSkoXHJcbiAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICBTb3J0YWJsZS5jcmVhdGUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRvci1wYW5lbCcpLCB7XHJcbiAgICAgICAgICAgIGdyb3VwOiB7bmFtZTonZWRpdG9yJywgcHVsbDogJ2Nsb25lJ30sXHJcbiAgICAgICAgICAgIGFuaW1hdGlvbjogMTAwLFxyXG4gICAgICAgICAgICBnaG9zdENsYXNzOiBcImdob3N0XCJcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBjcmVhdGVTcGFjZXMoKVxyXG5cclxuICAgICAgICAkKCcjY29udGFpbmVycycpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAkKCcjd2lkZ2V0JykuYXR0cignZGF0YS14eC13JywgdGhpcy52YWx1ZSlcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBsZXQgc3BhY2VzOlNwYWNlVGVtcGxhdGVbXSA9IFtdXHJcblxyXG4gICAgICAgICQoJyNjYWxjdWxhdGUnKS5vbignY2xpY2snLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBjYWxjdWxhdGUoKVxyXG4gICAgICAgICAgICBzYXZlKHNwYWNlcylcclxuICAgICAgICAgICAgc3BhY2VzID0gW11cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBcclxuICAgICAgICBpbml0KClcclxuICAgICAgICBmdW5jdGlvbiBjYWxjdWxhdGUoKSB7XHJcbiAgICAgICAgICAgICQoJy5zcGFjZScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZCA9ICQodGhpcykuYXR0cignZGF0YS14eC1zaWQnKVxyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudDogV2lkZ2V0W10gPSBbXVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAkKCdbZGF0YS14eC13aWRdJywgdGhpcykuZWFjaChmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50OkVsZW1lbnQgPSB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5wdXNoKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHd0eXBlOiAkKGVsZW1lbnQpLmF0dHIoJ2RhdGEteHgtd2lkZ2V0JyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZDogJChlbGVtZW50KS5hdHRyKCdkYXRhLXh4LXdpZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc05ldzogJChlbGVtZW50KS5oYXNDbGFzcygneHgtbmV3JylcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICBzcGFjZXMucHVzaCh7aWQsICBjb250ZW50fSlcclxuXHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpOnZvaWQge1xyXG4gICAgICAgICAgICAkKCcud2lkZ2V0LWluaXQnKS5lYWNoKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgaW5pdFdpZGdldCh0aGlzKVxyXG5cclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4pXHJcblxyXG4iXX0="}