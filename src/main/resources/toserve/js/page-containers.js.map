{"version":3,"sources":["node_modules/browser-pack/_prelude.js","frontend/ts/page-containers.ts"],"names":[],"mappings":"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","file":"page-containers.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\r\n//declarations\r\ndeclare interface SEvent {\r\n    from: HTMLElement\r\n    to: HTMLElement\r\n    item: HTMLElement\r\n    oldIndex?: number\r\n    newIndex?: number\r\n}\r\n\r\n\r\ninterface Space {\r\n    id: string\r\n    container?: string\r\n    content?: Container[]\r\n    level: number\r\n\r\n}\r\n\r\ninterface Container {\r\n    ctype: string\r\n    cid: string\r\n    isNew?: boolean\r\n}\r\n\r\ndeclare function createSpace(item: Element): void\r\n\r\ndeclare function createSpaces():void\r\n\r\ndeclare function initWidget(item: Element): void\r\n\r\ndeclare function loadHtml(id: string):void\r\n\r\ndeclare function save(containers: Space[]):void\r\n\r\n//global functions\r\n;(<any> window).initWidget = function(item: Element):void {\r\n\r\n    const containerStr: string = `\r\n        <div class=\"panel-heading\">\r\n            <button class=\"btn btn-primary btn-sm edit-button\">\r\n               <span class=\"glyphicon glyphicon-cog\"></span>\r\n            </button>\r\n            <button class=\"btn btn-primary btn-sm close-button\">\r\n               <span class=\"glyphicon glyphicon-remove\"></span>\r\n            </button>\r\n        </div>\r\n        <div class=\"panel-body\">\r\n            <div id=\"target\"></div>\r\n        </div>\r\n        `\r\n\r\n    const children = $(item).children().get(0)\r\n    $(item)\r\n    .removeAttr('id')\r\n    .addClass('panel panel-primary widget')\r\n    .html(containerStr)\r\n    .find('.close-button')\r\n    .on('click', function(){\r\n        item.remove()\r\n    })\r\n\r\n    if(children) $(item).find('.panel-body').append(children)\r\n\r\n}\r\n;(<any> window).createSpaces = function():void {\r\n\r\n    $('.space')\r\n    \r\n    .filter(function(){\r\n        return !$(this).hasClass('space-init')\r\n    })\r\n    .addClass('space-init')\r\n    .each(function(){\r\n        createSpace(this)\r\n    })\r\n\r\n}\r\n\r\n;(<any> window).createSpace = function(item:Element):void {\r\n  \r\n    Sortable.create(item, {\r\n        group: {\r\n            name: 'space',\r\n            put: ['editor', 'space']\r\n        } ,\r\n        animation: 100,\r\n        ghostClass: \"ghost\",\r\n        // delay: 10,\r\n        onAdd: function(event: SEvent) {\r\n            if(event.from.id == 'editor-panel') {\r\n                const item = event.item\r\n    \r\n                initWidget(item)\r\n                loadHtml($('#widget').attr('data-xx-w'))\r\n            //  createSpaces()\r\n            }\r\n        },\r\n        onUpdate: function(event: SEvent) {\r\n            const ids: string[] = []\r\n            $(event.to).children().each(\r\n                function(){\r\n                    ids.push(this.id)\r\n                })\r\n            // sort(event.to.id, ids)\r\n        },\r\n        onStart: function(event: SEvent) {\r\n            $(event.item)\r\n            .addClass('dragging')\r\n        },\r\n        onEnd: function(event: SEvent) {\r\n            $(event.item)\r\n            .removeClass('dragging')\r\n        },\r\n        draggable: '.widget'\r\n    })\r\n    }\r\n\r\n\r\n//the \"main\" method\r\n;(function(fn:()=>void) {\r\n  if (document.readyState != 'loading') fn()\r\n  else document.addEventListener('DOMContentLoaded', fn)\r\n})(\r\n    function() {\r\n        Sortable.create(document.getElementById('editor-panel'), {\r\n            group: {name:'editor', pull: 'clone'},\r\n            animation: 100,\r\n            ghostClass: \"ghost\"\r\n        })\r\n\r\n        createSpaces()\r\n\r\n        $('#containers').on('change', function(){\r\n            $('#widget').attr('data-xx-w', this.value)\r\n        })\r\n\r\n        let spaces:Space[] = []\r\n\r\n        $('#calculate').on('click', function(){\r\n            calculate()\r\n            // console.log(JSON.stringify(spaces))\r\n            save(spaces)\r\n            spaces = []\r\n        })\r\n\r\n        init()\r\n\r\n        function calculate() {\r\n\r\n\r\n            const top = $('.space-top')\r\n\r\n            function setTop(t:JQuery) {\r\n              const id = t.attr('data-xx-sid')\r\n              const container = t.attr('data-xx-c')\r\n              \r\n              const content: Container[] = []\r\n              const level = 0\r\n              \r\n              $('[data-xx-cid]', t.get(0)).each(function(){\r\n                  const element:Element = this\r\n                  content.push({\r\n                    cid: $(element).attr('data-xx-cid'),\r\n                    ctype: $(element).attr('data-xx-container'),\r\n                    isNew: $(element).hasClass('xx-new')\r\n                  })\r\n              })\r\n\r\n              spaces.push({id, container, content, level})\r\n            }\r\n            function findLevel(t: JQuery, l: number) {\r\n              t.addClass('space-in-work')\r\n              .find('.space:not(.space:not(.space-in-work) .space)')\r\n              .each(function(){\r\n                const id = $(this).attr('data-xx-sid')\r\n                const container = $(this).attr('data-xx-c')\r\n                \r\n                const content: Container[] = []\r\n                const level = l + 1\r\n                \r\n                $('[data-xx-cid]', this).each(function(){\r\n                    \r\n                  const element:Element = this\r\n                  content.push({\r\n                    cid: $(element).attr('data-xx-cid'),\r\n                    ctype: $(element).attr('data-xx-container'),\r\n                    isNew: $(element).hasClass('xx-new')\r\n                  })\r\n                })\r\n\r\n                spaces.push({id, container, content, level})\r\n\r\n                findLevel($(this), level)\r\n\r\n              })\r\n              t.removeClass('space-in-work')\r\n            }\r\n\r\n            setTop(top)\r\n            findLevel(top, 0)\r\n\r\n        }\r\n\r\n        function init():void {\r\n            $('[data-xx-container]').each(function(){\r\n\r\n                initWidget(this)\r\n                $('#target').remove()\r\n\r\n            })\r\n\r\n        }\r\n        \r\n        \r\n        \r\n    }\r\n)\r\n\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJmcm9udGVuZC90cy9wYWdlLWNvbnRhaW5lcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ29DUSxBQUFPLE9BQUMsQUFBVSxhQUFHLFVBQVMsQUFBYTtBQUUvQyxRQUFNLEFBQVksQUFBVyxBQVl4QjtBQUVMLFFBQU0sQUFBUSxXQUFHLEFBQUMsRUFBQyxBQUFJLEFBQUMsTUFBQyxBQUFRLEFBQUUsV0FBQyxBQUFHLElBQUMsQUFBQyxBQUFDO0FBQzFDLEFBQUMsTUFBQyxBQUFJLEFBQUMsTUFDTixBQUFVLFdBQUMsQUFBSSxBQUFDLE1BQ2hCLEFBQVEsU0FBQyxBQUE0QixBQUFDLDhCQUN0QyxBQUFJLEtBQUMsQUFBWSxBQUFDLGNBQ2xCLEFBQUksS0FBQyxBQUFlLEFBQUMsaUJBQ3JCLEFBQUUsR0FBQyxBQUFPLFNBQUU7QUFDVCxBQUFJLGFBQUMsQUFBTSxBQUFFLEFBQ2pCO0FBQUMsQUFBQztBQUVGLEFBQUUsUUFBQyxBQUFRLEFBQUMsVUFBQyxBQUFDLEVBQUMsQUFBSSxBQUFDLE1BQUMsQUFBSSxLQUFDLEFBQWEsQUFBQyxlQUFDLEFBQU0sT0FBQyxBQUFRLEFBQUMsQUFFN0Q7QUFBQyxBQUNBO0FBQU8sQUFBTyxPQUFDLEFBQVksZUFBRztBQUUzQixBQUFDLE1BQUMsQUFBUSxBQUFDLFVBRVYsQUFBTSxPQUFDO0FBQ0osQUFBTSxlQUFDLENBQUMsQUFBQyxFQUFDLEFBQUksQUFBQyxNQUFDLEFBQVEsU0FBQyxBQUFZLEFBQUMsQUFDMUM7QUFBQyxBQUFDLE9BQ0QsQUFBUSxTQUFDLEFBQVksQUFBQyxjQUN0QixBQUFJLEtBQUM7QUFDRixBQUFXLG9CQUFDLEFBQUksQUFBQyxBQUNyQjtBQUFDLEFBQUMsQUFFTjtBQUFDLEFBRUE7QUFBTyxBQUFPLE9BQUMsQUFBVyxjQUFHLFVBQVMsQUFBWTtBQUUvQyxBQUFRLGFBQUMsQUFBTSxPQUFDLEFBQUk7QUFD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QUFBbUIsQUFBQztBQUMzQyxBQUFLLCtCQUFFLEFBQUMsRUFBQyxBQUFPLEFBQUMsU0FBQyxBQUFRLFNBQUMsQUFBUSxBQUFDLEFBQ3JDLEFBQUMsQUFDSjtBQUxlO0FBS2QsQUFBQztBQUVGLEFBQU0sdUJBQUMsQUFBSSxLQUFDLEVBQUMsQUFBRSxRQUFFLEFBQVMsc0JBQUUsQUFBTyxrQkFBRSxBQUFLLEFBQUMsQUFBQztBQUU1QyxBQUFTLDBCQUFDLEFBQUMsRUFBQyxBQUFJLEFBQUMsT0FBRSxBQUFLLEFBQUMsQUFFM0I7QUFBQyxBQUFDO0FBQ0YsQUFBQyxjQUFDLEFBQVcsWUFBQyxBQUFlLEFBQUMsQUFDaEM7QUFBQztBQUVELEFBQU0sZUFBQyxBQUFHLEFBQUM7QUFDWCxBQUFTLGtCQUFDLEFBQUcsS0FBRSxBQUFDLEFBQUMsQUFFckI7QUFBQztBQUVEO0FBQ0ksQUFBQyxVQUFDLEFBQXFCLEFBQUMsdUJBQUMsQUFBSSxLQUFDO0FBRTFCLEFBQVUsdUJBQUMsQUFBSSxBQUFDO0FBQ2hCLEFBQUMsY0FBQyxBQUFTLEFBQUMsV0FBQyxBQUFNLEFBQUUsQUFFekI7QUFBQyxBQUFDLEFBRU47QUFBQyxBQUlMO0FBQUMsQUFDSiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcclxuLy9kZWNsYXJhdGlvbnNcclxuZGVjbGFyZSBpbnRlcmZhY2UgU0V2ZW50IHtcclxuICAgIGZyb206IEhUTUxFbGVtZW50XHJcbiAgICB0bzogSFRNTEVsZW1lbnRcclxuICAgIGl0ZW06IEhUTUxFbGVtZW50XHJcbiAgICBvbGRJbmRleD86IG51bWJlclxyXG4gICAgbmV3SW5kZXg/OiBudW1iZXJcclxufVxyXG5cclxuXHJcbmludGVyZmFjZSBTcGFjZSB7XHJcbiAgICBpZDogc3RyaW5nXHJcbiAgICBjb250YWluZXI/OiBzdHJpbmdcclxuICAgIGNvbnRlbnQ/OiBDb250YWluZXJbXVxyXG4gICAgbGV2ZWw6IG51bWJlclxyXG5cclxufVxyXG5cclxuaW50ZXJmYWNlIENvbnRhaW5lciB7XHJcbiAgICBjdHlwZTogc3RyaW5nXHJcbiAgICBjaWQ6IHN0cmluZ1xyXG4gICAgaXNOZXc/OiBib29sZWFuXHJcbn1cclxuXHJcbmRlY2xhcmUgZnVuY3Rpb24gY3JlYXRlU3BhY2UoaXRlbTogRWxlbWVudCk6IHZvaWRcclxuXHJcbmRlY2xhcmUgZnVuY3Rpb24gY3JlYXRlU3BhY2VzKCk6dm9pZFxyXG5cclxuZGVjbGFyZSBmdW5jdGlvbiBpbml0V2lkZ2V0KGl0ZW06IEVsZW1lbnQpOiB2b2lkXHJcblxyXG5kZWNsYXJlIGZ1bmN0aW9uIGxvYWRIdG1sKGlkOiBzdHJpbmcpOnZvaWRcclxuXHJcbmRlY2xhcmUgZnVuY3Rpb24gc2F2ZShjb250YWluZXJzOiBTcGFjZVtdKTp2b2lkXHJcblxyXG4vL2dsb2JhbCBmdW5jdGlvbnNcclxuOyg8YW55PiB3aW5kb3cpLmluaXRXaWRnZXQgPSBmdW5jdGlvbihpdGVtOiBFbGVtZW50KTp2b2lkIHtcclxuXHJcbiAgICBjb25zdCBjb250YWluZXJTdHI6IHN0cmluZyA9IGBcclxuICAgICAgICA8ZGl2IGNsYXNzPVwicGFuZWwtaGVhZGluZ1wiPlxyXG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1zbSBlZGl0LWJ1dHRvblwiPlxyXG4gICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tY29nXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBidG4tc20gY2xvc2UtYnV0dG9uXCI+XHJcbiAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmVcIj48L3NwYW4+XHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJwYW5lbC1ib2R5XCI+XHJcbiAgICAgICAgICAgIDxkaXYgaWQ9XCJ0YXJnZXRcIj48L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICBgXHJcblxyXG4gICAgY29uc3QgY2hpbGRyZW4gPSAkKGl0ZW0pLmNoaWxkcmVuKCkuZ2V0KDApXHJcbiAgICAkKGl0ZW0pXHJcbiAgICAucmVtb3ZlQXR0cignaWQnKVxyXG4gICAgLmFkZENsYXNzKCdwYW5lbCBwYW5lbC1wcmltYXJ5IHdpZGdldCcpXHJcbiAgICAuaHRtbChjb250YWluZXJTdHIpXHJcbiAgICAuZmluZCgnLmNsb3NlLWJ1dHRvbicpXHJcbiAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgICAgICBpdGVtLnJlbW92ZSgpXHJcbiAgICB9KVxyXG5cclxuICAgIGlmKGNoaWxkcmVuKSAkKGl0ZW0pLmZpbmQoJy5wYW5lbC1ib2R5JykuYXBwZW5kKGNoaWxkcmVuKVxyXG5cclxufVxyXG47KDxhbnk+IHdpbmRvdykuY3JlYXRlU3BhY2VzID0gZnVuY3Rpb24oKTp2b2lkIHtcclxuXHJcbiAgICAkKCcuc3BhY2UnKVxyXG4gICAgXHJcbiAgICAuZmlsdGVyKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuICEkKHRoaXMpLmhhc0NsYXNzKCdzcGFjZS1pbml0JylcclxuICAgIH0pXHJcbiAgICAuYWRkQ2xhc3MoJ3NwYWNlLWluaXQnKVxyXG4gICAgLmVhY2goZnVuY3Rpb24oKXtcclxuICAgICAgICBjcmVhdGVTcGFjZSh0aGlzKVxyXG4gICAgfSlcclxuXHJcbn1cclxuXHJcbjsoPGFueT4gd2luZG93KS5jcmVhdGVTcGFjZSA9IGZ1bmN0aW9uKGl0ZW06RWxlbWVudCk6dm9pZCB7XHJcbiAgXHJcbiAgICBTb3J0YWJsZS5jcmVhdGUoaXRlbSwge1xyXG4gICAgICAgIGdyb3VwOiB7XHJcbiAgICAgICAgICAgIG5hbWU6ICdzcGFjZScsXHJcbiAgICAgICAgICAgIHB1dDogWydlZGl0b3InLCAnc3BhY2UnXVxyXG4gICAgICAgIH0gLFxyXG4gICAgICAgIGFuaW1hdGlvbjogMTAwLFxyXG4gICAgICAgIGdob3N0Q2xhc3M6IFwiZ2hvc3RcIixcclxuICAgICAgICAvLyBkZWxheTogMTAsXHJcbiAgICAgICAgb25BZGQ6IGZ1bmN0aW9uKGV2ZW50OiBTRXZlbnQpIHtcclxuICAgICAgICAgICAgaWYoZXZlbnQuZnJvbS5pZCA9PSAnZWRpdG9yLXBhbmVsJykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGV2ZW50Lml0ZW1cclxuICAgIFxyXG4gICAgICAgICAgICAgICAgaW5pdFdpZGdldChpdGVtKVxyXG4gICAgICAgICAgICAgICAgbG9hZEh0bWwoJCgnI3dpZGdldCcpLmF0dHIoJ2RhdGEteHgtdycpKVxyXG4gICAgICAgICAgICAvLyAgY3JlYXRlU3BhY2VzKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25VcGRhdGU6IGZ1bmN0aW9uKGV2ZW50OiBTRXZlbnQpIHtcclxuICAgICAgICAgICAgY29uc3QgaWRzOiBzdHJpbmdbXSA9IFtdXHJcbiAgICAgICAgICAgICQoZXZlbnQudG8pLmNoaWxkcmVuKCkuZWFjaChcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWRzLnB1c2godGhpcy5pZClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8vIHNvcnQoZXZlbnQudG8uaWQsIGlkcylcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uU3RhcnQ6IGZ1bmN0aW9uKGV2ZW50OiBTRXZlbnQpIHtcclxuICAgICAgICAgICAgJChldmVudC5pdGVtKVxyXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2RyYWdnaW5nJylcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uRW5kOiBmdW5jdGlvbihldmVudDogU0V2ZW50KSB7XHJcbiAgICAgICAgICAgICQoZXZlbnQuaXRlbSlcclxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdkcmFnZ2luZycpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkcmFnZ2FibGU6ICcud2lkZ2V0J1xyXG4gICAgfSlcclxuICAgIH1cclxuXHJcblxyXG4vL3RoZSBcIm1haW5cIiBtZXRob2RcclxuOyhmdW5jdGlvbihmbjooKT0+dm9pZCkge1xyXG4gIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9ICdsb2FkaW5nJykgZm4oKVxyXG4gIGVsc2UgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZuKVxyXG59KShcclxuICAgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIFNvcnRhYmxlLmNyZWF0ZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdG9yLXBhbmVsJyksIHtcclxuICAgICAgICAgICAgZ3JvdXA6IHtuYW1lOidlZGl0b3InLCBwdWxsOiAnY2xvbmUnfSxcclxuICAgICAgICAgICAgYW5pbWF0aW9uOiAxMDAsXHJcbiAgICAgICAgICAgIGdob3N0Q2xhc3M6IFwiZ2hvc3RcIlxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGNyZWF0ZVNwYWNlcygpXHJcblxyXG4gICAgICAgICQoJyNjb250YWluZXJzJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICQoJyN3aWRnZXQnKS5hdHRyKCdkYXRhLXh4LXcnLCB0aGlzLnZhbHVlKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGxldCBzcGFjZXM6U3BhY2VbXSA9IFtdXHJcblxyXG4gICAgICAgICQoJyNjYWxjdWxhdGUnKS5vbignY2xpY2snLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBjYWxjdWxhdGUoKVxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzcGFjZXMpKVxyXG4gICAgICAgICAgICBzYXZlKHNwYWNlcylcclxuICAgICAgICAgICAgc3BhY2VzID0gW11cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBpbml0KClcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FsY3VsYXRlKCkge1xyXG5cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHRvcCA9ICQoJy5zcGFjZS10b3AnKVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gc2V0VG9wKHQ6SlF1ZXJ5KSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgaWQgPSB0LmF0dHIoJ2RhdGEteHgtc2lkJylcclxuICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSB0LmF0dHIoJ2RhdGEteHgtYycpXHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgY29uc3QgY29udGVudDogQ29udGFpbmVyW10gPSBbXVxyXG4gICAgICAgICAgICAgIGNvbnN0IGxldmVsID0gMFxyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICQoJ1tkYXRhLXh4LWNpZF0nLCB0LmdldCgwKSkuZWFjaChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50OkVsZW1lbnQgPSB0aGlzXHJcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2lkOiAkKGVsZW1lbnQpLmF0dHIoJ2RhdGEteHgtY2lkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY3R5cGU6ICQoZWxlbWVudCkuYXR0cignZGF0YS14eC1jb250YWluZXInKSxcclxuICAgICAgICAgICAgICAgICAgICBpc05ldzogJChlbGVtZW50KS5oYXNDbGFzcygneHgtbmV3JylcclxuICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICBzcGFjZXMucHVzaCh7aWQsIGNvbnRhaW5lciwgY29udGVudCwgbGV2ZWx9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbmRMZXZlbCh0OiBKUXVlcnksIGw6IG51bWJlcikge1xyXG4gICAgICAgICAgICAgIHQuYWRkQ2xhc3MoJ3NwYWNlLWluLXdvcmsnKVxyXG4gICAgICAgICAgICAgIC5maW5kKCcuc3BhY2U6bm90KC5zcGFjZTpub3QoLnNwYWNlLWluLXdvcmspIC5zcGFjZSknKVxyXG4gICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZCA9ICQodGhpcykuYXR0cignZGF0YS14eC1zaWQnKVxyXG4gICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gJCh0aGlzKS5hdHRyKCdkYXRhLXh4LWMnKVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50OiBDb250YWluZXJbXSA9IFtdXHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZXZlbCA9IGwgKyAxXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICQoJ1tkYXRhLXh4LWNpZF0nLCB0aGlzKS5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQ6RWxlbWVudCA9IHRoaXNcclxuICAgICAgICAgICAgICAgICAgY29udGVudC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBjaWQ6ICQoZWxlbWVudCkuYXR0cignZGF0YS14eC1jaWQnKSxcclxuICAgICAgICAgICAgICAgICAgICBjdHlwZTogJChlbGVtZW50KS5hdHRyKCdkYXRhLXh4LWNvbnRhaW5lcicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTmV3OiAkKGVsZW1lbnQpLmhhc0NsYXNzKCd4eC1uZXcnKVxyXG4gICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICBzcGFjZXMucHVzaCh7aWQsIGNvbnRhaW5lciwgY29udGVudCwgbGV2ZWx9KVxyXG5cclxuICAgICAgICAgICAgICAgIGZpbmRMZXZlbCgkKHRoaXMpLCBsZXZlbClcclxuXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICB0LnJlbW92ZUNsYXNzKCdzcGFjZS1pbi13b3JrJylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0VG9wKHRvcClcclxuICAgICAgICAgICAgZmluZExldmVsKHRvcCwgMClcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpbml0KCk6dm9pZCB7XHJcbiAgICAgICAgICAgICQoJ1tkYXRhLXh4LWNvbnRhaW5lcl0nKS5lYWNoKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgaW5pdFdpZGdldCh0aGlzKVxyXG4gICAgICAgICAgICAgICAgJCgnI3RhcmdldCcpLnJlbW92ZSgpXHJcblxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICB9XHJcbilcclxuXHJcbiJdfQ=="}